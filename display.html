<!DOCTYPE html>
<html>
    <head>
        <meta charset='utf-8'>
        <title>superestate.com</title>
		<link rel="stylesheet" type="text/css" href="styles/styles.css"></link>
		<link rel="stylesheet" type="text/css" href="styles/displayStyles.css"></link>
		<script src="scripts/getURLParam.js"></script>
		<script src="scripts/navLoaded.js"></script>
		<script src="scripts/display.js"></script>
		<script src="scripts/getMap.js"></script>
		<script src="https://code.jquery.com/jquery-1.12.4.js"></script>
		<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
		<script src="https://cdn.apple-mapkit.com/mk/5.x.x/mapkit.js"></script>
		<script
		src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDHoKTlzPooE2GOaFauWyvrzYjBxxY9wms&callback=initMap&libraries=&v=weekly"
		defer
	  ></script>
	</head>
	
    <body onload="navLoaded();">
		<div class="content">
			<div class="slides-container">
				<div class="photo-container">
					<script>document.writeln('<img src="images/house'+ getURLParam('id') +'.jpg" class="property-photo" alt="Property for Sale">');</script>
				</div>
				<script>
					var photoCount;
					var videoCount;
					$(document).ready(function() {
						$.get('getPropertyPhotos.php', {id:getURLParam('id')}, function(data) {
							var dataArray = data.split(",");
							photoCount = dataArray[0];
							videoCount = dataArray[1];

							s = document.getElementsByClassName("slides-container")[0];

							for(var i=1;i<parseInt(photoCount)+1;++i)
							{
								var divNode = document.createElement("div");
								divNode.setAttribute("class", "photo-container");
								var imgNode = document.createElement("img");
								imgNode.setAttribute("src", ("images/house" + getURLParam('id') + "_" + i + ".jpg"));
								imgNode.setAttribute("alt", "Property for Sale");
								imgNode.setAttribute("class", "property-photo");

								divNode.appendChild(imgNode);
								s.appendChild(divNode);

								showSlides(1);
							}

							if(photoCount > 0)
							{
								var prevNode = document.createElement("a");
								prevNode.setAttribute("class", "prev");
								prevNode.setAttribute("onclick", "plusSlides(-1)");
								var prevTextNode = document.createTextNode('\u2b05');
								prevNode.appendChild(prevTextNode);

								var nextNode = document.createElement("a");
								nextNode.setAttribute("class", "next");
								nextNode.setAttribute("onclick", "plusSlides(+1)");
								var nextTextNode = document.createTextNode('\u27a1');
								nextNode.appendChild(nextTextNode);

								s.appendChild(prevNode);
								s.appendChild(nextNode);
							}
						});
					});
				</script>
			</div>
			<div class="propertyDetails">
				<script>
					document.writeln('<iframe src="getDetails.php?id='+ getURLParam('id') +' width="100%" height="100%"></iframe>');
				</script>
				<div id="map">
					<script>
						var propertyAddress;
						$(document).ready(function() {
							$.get('getPropertyAddress.php', {id:getURLParam('id')}, function(data) {
								propertyAddress = data;
								
								// Uses Apple WebMap
								//displayAppleMap(propertyAddress, "map");

								// Only needed when using Google via http
								//propertyAddress = data.replace(/, /g, "%20");

								// Uses Google Maps
								p = document.getElementById("map");
								var iframeNode = document.createElement("iframe");
								iframeNode.setAttribute("id", "map");
								iframeNode.setAttribute("src", "https://www.google.com/maps/embed/v1/place?key=AIzaSyDHoKTlzPooE2GOaFauWyvrzYjBxxY9wms&q=" + propertyAddress);
								p.appendChild(iframeNode);

								// Uses Google Maps
								// This works but will only display the map
								//document.writeln("<iframe id=\"map\"" +
								//	"src=\"https://maps.google.com/maps?width=520&amp;height=400&amp;hl=en&amp;q=" + propertyAddress + "+(home)&amp;t=&amp;z=18&amp;ie=UTF8&amp;iwloc=B&amp;output=embed\"></iframe>");
							});
						});
					</script>
				</div>
			</div>
		</div>
    </body>
</html>

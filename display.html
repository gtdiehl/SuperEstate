<!DOCTYPE html>
<html>
    <head>
        <meta charset='utf-8'>
        <title>superestate.com</title>
        <link rel="stylesheet" type="text/css" href="styles/styles.css"></link>
        
        <script src="scripts/search.js"></script>
        <script src="scripts/utils.js"></script>
        <script>
            var myDataObj;
            const queryString = window.location.search;
            const urlParams = new URLSearchParams(queryString);
            const property_id = urlParams.get('property_id');
            const display_nav = urlParams.get('display_nav');

            function domLoaded() {
                if(display_nav == "True") {
                    let div = document.createElement("div");
                    div.setAttribute("class", "nav");

                    let unorderedList = document.createElement("UL");
                    div.appendChild(unorderedList);

                    let listItem1 = document.createElement("LI");
                    listItem1.setAttribute("class", "navList");
                    unorderedList.appendChild(listItem1);
                    

                    let homeLink = document.createElement("A");
                    homeLink.setAttribute("href","index.html");
                    homeLink.setAttribute("class", "homepage");
                    listItem1.appendChild(homeLink);
                    
                    let imgsrc = document.createElement("IMG");
                    imgsrc.setAttribute("src", "images/logo.jpg");
                    imgsrc.setAttribute("alt", "SuperEstate logo");
                    imgsrc.setAttribute("width", 140);
                    imgsrc.setAttribute("height", 75);
                    homeLink.appendChild(imgsrc);

                    let listItem2 = document.createElement("LI");
                    listItem2.setAttribute("class", "navList");
                    unorderedList.appendChild(listItem2);
                    
                    let searchLink = document.createElement("A");
                    searchLink.setAttribute("href", "search.html");
                    listItem2.appendChild(searchLink);

                    let searchText = document.createTextNode("Search a house");
                    searchLink.appendChild(searchText);


                    let listItem3 = document.createElement("LI");
                    listItem3.setAttribute("class", "navList");
                    unorderedList.appendChild(listItem3);
                    
                    let sellLink = document.createElement("A");
                    sellLink.setAttribute("href", "#sell");
                    listItem3.appendChild(sellLink);

                    let sellText = document.createTextNode("Sell a house");
                    sellLink.appendChild(sellText);

                    let listItem4 = document.createElement("LI");
                    listItem4.setAttribute("class", "navList");
                    unorderedList.appendChild(listItem4);
                    
                    let aboutLink = document.createElement("A");
                    aboutLink.setAttribute("href", "#about");
                    listItem4.appendChild(aboutLink);

                    let aboutText = document.createTextNode("Agents");
                    aboutLink.appendChild(aboutText);

                    let listItem5 = document.createElement("LI");
                    listItem5.setAttribute("class", "navList");
                    unorderedList.appendChild(listItem5);
                    
                    let contactLink = document.createElement("A");
                    contactLink.setAttribute("href", "#about");
                    listItem5.appendChild(contactLink);

                    let contactText = document.createTextNode("Contact us");
                    contactLink.appendChild(contactText);

                    let listItem6 = document.createElement("LI");
                    listItem6.setAttribute("class", "navList");
                    unorderedList.appendChild(listItem6);
                    
                    let mypropertyLink = document.createElement("A");
                    mypropertyLink.setAttribute("href", "#account");
                    mypropertyLink.setAttribute("class", "special");
                    listItem6.appendChild(mypropertyLink);

                    let mypropertyText = document.createTextNode("My property");
                    mypropertyLink.appendChild(mypropertyText);

                    document.body.insertBefore(div, document.body.firstChild);
                }

                loadHomeData();
            }

            function loadHomeData() {
                var reader = new FileReader();
                var data = JSON.stringify(homeData);
                const blob = new Blob([data], {type:"application/json"});

                reader.onload = function(event) {
                    myDataObj = JSON.parse(event.target.result);
                    myDataObj.forEach(element => {
                        if(element.ref == property_id) {
                            document.getElementById("propertyDetailsList").innerHTML += ('<li>Bedrooms: ' + element.Bedrooms +'</li>');
                            document.getElementById("propertyDetailsList").innerHTML += ('<li>Bathrooms: ' + element.Bathrooms + '</li>');
                            document.getElementById("property-photo").src = element.image;
                        }
                    });
                };

                reader.onerror = function(event) {
                    console.error("File could not be read! Code " + event.target.error.code);
                };

                reader.readAsText(blob);
            }         

            var slideIndex = 1;
            showDivs(slideIndex);

            function plusDivs(n) {
                showDivs(slideIndex += n);
            }

            function showDivs(n) {
                var i;
                var x = document.getElementsByClassName("mySlides");
                if (n > x.length) {slideIndex = 1}
                    if (n < 1) {slideIndex = x.length} ;
                        for (i = 0; i < x.length; i++) {
                            x[i].style.display = "none";
                        }
                x[slideIndex-1].style.display = "block";
            }
        </script>
        <style>
            .displayContent {
                width: 90%;
                height: 20%;
                position: fixed;
                top: 100px;
                padding: 10px 10px 0px;
                margin-left:3%;
            }

            .photo-container {
                float: left;
                width: auto;
                height: auto;
            }

            .propertyDetails {
                float: left;
            }

            #propertyDetailsList {
                list-style-type: disc;
            }

            .property-display-left {
                position: absolute;
                top: 100%;
                left: 0%;
            }

            .property-display-right {
                position: absolute;
                top: 100%;
                right: 0%;
            }

            .property-button {
                padding: 8px 16px;
                margin-left: 1%;
                overflow: hidden;
            }

            .property-photo {
                width: 75%;
                height: 75%;
            }

        </style>
    </head>
    <body onload="domLoaded();">
        <div id="displayContent" class="displayContent">
            <div class="photo-container">
                <img id="property-photo" class="property-photo" src="" alt="Property for Sale">
                <button class="property-button property-display-left" onclick="plusDivs(-1)">&#10094;</button>
                <button class="property-button property-display-right" onclick="plusDivs(+1)">&#10095;</button>
            </div>
            <div class="propertyDetails">
                <ul id="propertyDetailsList"></ul>
            </div>
        </div>
    </body>
</html>
